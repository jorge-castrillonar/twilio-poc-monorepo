server:
  port: 8085

spring:
  application:
    name: auth-service
  
  # Database Configuration
  datasource:
    url: ${SPRING_DATASOURCE_URL:jdbc:postgresql://auth-db:5432/authdb}
    username: ${SPRING_DATASOURCE_USERNAME:authservice}
    password: ${SPRING_DATASOURCE_PASSWORD:authpass}
    driver-class-name: org.postgresql.Driver
    hikari:
      maximum-pool-size: 10
      minimum-idle: 5
      connection-timeout: 30000
  
  # JPA Configuration
  jpa:
    hibernate:
      ddl-auto: validate
    show-sql: false
    properties:
      hibernate:
        format_sql: false
        dialect: org.hibernate.dialect.PostgreSQLDialect
        jdbc:
          time_zone: UTC
  
  # Flyway Configuration
  flyway:
    enabled: true
    baseline-on-migrate: true
    locations: classpath:db/migration
  
  # ActiveMQ Configuration
  activemq:
    broker-url: ${ACTIVEMQ_BROKER_URL:tcp://activemq:61616}
    user: admin
    password: admin
    packages:
      trust-all: true
  
  # Redis Configuration
  data:
    redis:
      host: ${REDIS_HOST:redis}
      port: ${REDIS_PORT:6379}
      timeout: 2000ms
      lettuce:
        pool:
          max-active: 8
          max-idle: 8
          min-idle: 0

# JWT Configuration
jwt:
  public-key: ${JWT_PUBLIC_KEY}
  private-key-path: file:/app/keys/private_key.pem
  access-token-expiration: 900000
  refresh-token-expiration: 604800000
  issuer: auth-service

# Rate Limiting Configuration
rate-limit:
  login:
    max-attempts: 5
    duration-seconds: 300
  refresh:
    max-attempts: 10
    duration-seconds: 60

# User Service Configuration
user-service:
  base-url: ${USER_SERVICE_URL:http://user-service:8084}
  endpoints:
    validate-credentials: /api/credentials/validate
    get-user: /api/users/{userId}

# MFA Configuration
mfa:
  issuer: CCAI-Collections
  time-step-seconds: 30
  window: 1

# Logging
logging:
  level:
    com.allcode.auth: INFO
    org.springframework.security: WARN
    org.springframework.web: WARN
